{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="Real-time weather forecasts and agricultural alerts for farmers - Kissan Connect">
    <meta name="keywords" content="weather forecast, agricultural alerts, farming weather, crop weather">
    
    <title>Weather Intelligence - Kissan Connect</title>
    
    <!-- Bootstrap 5 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome 6 -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- AOS Animation -->
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
    <!-- Custom CSS -->
    <link href="{% static 'css/style.css' %}" rel="stylesheet">
    
    <!-- Favicon -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üå§Ô∏è</text></svg>">
</head>

<body>
    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg navbar-dark fixed-top glass-navbar" id="mainNavbar">
        <div class="container">
            <a class="navbar-brand brand-glow" href="{% url 'main:index' %}">
                <i class="fas fa-seedling me-2 rotating-icon"></i>
                <span class="brand-text">Kissan Connect</span>
            </a>
            
            <button class="navbar-toggler border-0" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <a class="nav-link nav-link-modern" href="{% url 'main:index' %}">
                            <i class="fas fa-home me-1"></i>Home
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link nav-link-modern" href="{% url 'main:services' %}">
                            <i class="fas fa-cogs me-1"></i>Services
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link nav-link-modern active" href="{% url 'main:weather' %}">
                            <i class="fas fa-cloud-sun me-1"></i>Weather
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link nav-link-modern" href="{% url 'main:crop_suggestions' %}">
                            <i class="fas fa-seedling me-1"></i>Crop AI
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link nav-link-modern" href="{% url 'main:contact' %}">
                            <i class="fas fa-envelope me-1"></i>Contact
                        </a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Weather Hero Section -->
    <section class="weather-hero-section">
        <div class="weather-particles"></div>
        <div class="container">
            <div class="row align-items-center min-vh-100">
                <div class="col-lg-8 mx-auto text-center">
                    <div class="weather-hero-content" data-aos="fade-up">
                        <div class="weather-badge mb-4">
                            <i class="fas fa-satellite me-2"></i>
                            <span>Real-Time Weather Intelligence</span>
                        </div>
                        <h1 class="weather-hero-title">
                            Smart Weather for 
                            <span class="text-gradient">Smart Farming</span>
                        </h1>
                        <p class="weather-hero-description">
                            Get accurate weather forecasts, severe weather alerts, and agricultural insights 
                            tailored specifically for your farming needs.
                        </p>
                        
                        <!-- Location Input -->
                        <div class="weather-search-container">
                            <div class="weather-search-box">
                                <div class="input-group">
                                    <span class="input-group-text weather-search-icon">
                                        <i class="fas fa-map-marker-alt"></i>
                                    </span>
                                    <input type="text" class="form-control weather-search-input" 
                                           id="locationInput" placeholder="Enter your city or village name...">
                                    <button class="btn btn-weather-search" type="button" onclick="getWeatherData()">
                                        <i class="fas fa-search me-2"></i>Get Weather
                                    </button>
                                </div>
                                <div class="weather-gps-option">
                                    <button class="btn-gps-weather" onclick="detectLocationForWeather()">
                                        <i class="fas fa-crosshairs me-2"></i>Use My Location
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Current Weather Section -->
    <section class="current-weather-section" id="currentWeatherSection" style="display: none;">
        <div class="container">
            <div class="current-weather-card" data-aos="fade-up">
                <div class="row align-items-center">
                    <div class="col-lg-4">
                        <div class="current-weather-main">
                            <div class="weather-icon-main" id="currentWeatherIcon">
                                <i class="fas fa-sun"></i>
                            </div>
                            <div class="current-temp" id="currentTemp">--¬∞</div>
                            <div class="weather-description" id="weatherDescription">Loading...</div>
                            <div class="feels-like">Feels like <span id="feelsLike">--¬∞</span></div>
                        </div>
                    </div>
                    <div class="col-lg-4">
                        <div class="weather-location-info">
                            <h3 class="location-name" id="locationName">
                                <i class="fas fa-map-marker-alt me-2"></i>
                                Your Location
                            </h3>
                            <div class="location-time" id="locationTime">
                                <i class="fas fa-clock me-2"></i>
                                <span id="currentTime">--:--</span>
                            </div>
                            <div class="weather-date" id="weatherDate">
                                <i class="fas fa-calendar me-2"></i>
                                <span id="currentDate">Loading...</span>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-4">
                        <div class="weather-details-grid">
                            <div class="weather-detail-item">
                                <div class="detail-icon">
                                    <i class="fas fa-tint"></i>
                                </div>
                                <div class="detail-info">
                                    <span class="detail-label">Humidity</span>
                                    <span class="detail-value" id="humidity">--%</span>
                                </div>
                            </div>
                            <div class="weather-detail-item">
                                <div class="detail-icon">
                                    <i class="fas fa-wind"></i>
                                </div>
                                <div class="detail-info">
                                    <span class="detail-label">Wind Speed</span>
                                    <span class="detail-value" id="windSpeed">-- km/h</span>
                                </div>
                            </div>
                            <div class="weather-detail-item">
                                <div class="detail-icon">
                                    <i class="fas fa-thermometer-half"></i>
                                </div>
                                <div class="detail-info">
                                    <span class="detail-label">Pressure</span>
                                    <span class="detail-value" id="pressure">-- hPa</span>
                                </div>
                            </div>
                            <div class="weather-detail-item">
                                <div class="detail-icon">
                                    <i class="fas fa-eye"></i>
                                </div>
                                <div class="detail-info">
                                    <span class="detail-label">Visibility</span>
                                    <span class="detail-value" id="visibility">-- km</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- 5-Day Forecast Section -->
    <section class="forecast-section" id="forecastSection" style="display: none;">
        <div class="container">
            <div class="section-header text-center mb-5" data-aos="fade-up">
                <h2 class="section-title-weather">
                    <i class="fas fa-calendar-week me-3"></i>
                    5-Day Weather Forecast
                </h2>
                <p class="section-subtitle-weather">Plan your farming activities with our accurate forecasts</p>
            </div>
            
            <div class="forecast-container" id="forecastContainer">
                <!-- Forecast cards will be dynamically generated here -->
            </div>
        </div>
    </section>

    <!-- Agricultural Alerts Section -->
    <section class="agricultural-alerts-section" id="alertsSection" style="display: none;">
        <div class="container">
            <div class="section-header text-center mb-5" data-aos="fade-up">
                <h2 class="section-title-weather">
                    <i class="fas fa-exclamation-triangle me-3"></i>
                    Agricultural Weather Alerts
                </h2>
                <p class="section-subtitle-weather">Important weather-based farming recommendations</p>
            </div>
            
            <div class="alerts-container" id="alertsContainer">
                <!-- Alerts will be dynamically generated here -->
            </div>
        </div>
    </section>

    <!-- Replace your current stats section with this enhanced version -->
<section class="weather-stats-section" id="statsSection" style="display: none;">
    <div class="container">
        <div class="row g-4">
            <div class="col-lg-3 col-md-6" data-aos="fade-up" data-aos-delay="100">
                <div class="weather-stat-card">
                    <div class="stat-icon uv-icon">
                        <i class="fas fa-sun"></i>
                    </div>
                    <div class="stat-content">
                        <h4 class="stat-title">UV Index</h4>
                        <div class="stat-value" id="uvIndex">--</div>
                        <div class="stat-description" id="uvDescription">Moderate</div>
                    </div>
                </div>
            </div>
            
            <div class="col-lg-3 col-md-6" data-aos="fade-up" data-aos-delay="200">
                <div class="weather-stat-card">
                    <div class="stat-icon rain-icon">
                        <i class="fas fa-cloud-rain"></i>
                    </div>
                    <div class="stat-content">
                        <h4 class="stat-title">Rainfall</h4>
                        <div class="stat-value" id="rainfall">-- mm</div>
                        <div class="stat-description">Last 24 hours</div>
                    </div>
                </div>
            </div>
            
            <div class="col-lg-3 col-md-6" data-aos="fade-up" data-aos-delay="300">
                <div class="weather-stat-card">
                    <div class="stat-icon sunrise-icon">
                        <div class="sunrise-sunset-icon">
                            <div class="sun-circle"></div>
                            <div class="horizon-line"></div>
                            <div class="sun-rays">
                                <div class="ray ray-1"></div>
                                <div class="ray ray-2"></div>
                                <div class="ray ray-3"></div>
                                <div class="ray ray-4"></div>
                            </div>
                        </div>
                    </div>
                    <div class="stat-content">
                        <h4 class="stat-title">Sunrise</h4>
                        <div class="stat-value" id="sunriseTime">--:--</div>
                        <div class="stat-description">Today</div>
                    </div>
                </div>
            </div>
            
            <div class="col-lg-3 col-md-6" data-aos="fade-up" data-aos-delay="400">
                <div class="weather-stat-card">
                    <div class="stat-icon sunset-icon">
                        <div class="sunrise-sunset-icon sunset-version">
                            <div class="sun-circle"></div>
                            <div class="horizon-line"></div>
                            <div class="sun-rays">
                                <div class="ray ray-1"></div>
                                <div class="ray ray-2"></div>
                                <div class="ray ray-3"></div>
                                <div class="ray ray-4"></div>
                            </div>
                        </div>
                    </div>
                    <div class="stat-content">
                        <h4 class="stat-title">Sunset</h4>
                        <div class="stat-value" id="sunsetTime">--:--</div>
                        <div class="stat-description">Today</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

    <!-- Farming Tips Section -->
    <section class="farming-tips-section" id="farmingTipsSection" style="display: none;">
        <div class="container">
            <div class="section-header text-center mb-5" data-aos="fade-up">
                <h2 class="section-title-weather">
                    <i class="fas fa-lightbulb me-3"></i>
                    Weather-Based Farming Tips
                </h2>
                <p class="section-subtitle-weather">Smart recommendations based on current weather conditions</p>
            </div>
            
            <div class="row g-4">
                <div class="col-lg-4" data-aos="fade-up" data-aos-delay="100">
                    <div class="farming-tip-card">
                        <div class="tip-icon">
                            <i class="fas fa-seedling"></i>
                        </div>
                        <h5 class="tip-title">Planting & Sowing</h5>
                        <div class="tip-content" id="plantingTips">
                            Loading weather-based planting recommendations...
                        </div>
                    </div>
                </div>
                
                <div class="col-lg-4" data-aos="fade-up" data-aos-delay="200">
                    <div class="farming-tip-card">
                        <div class="tip-icon">
                            <i class="fas fa-tint"></i>
                        </div>
                        <h5 class="tip-title">Irrigation & Water</h5>
                        <div class="tip-content" id="irrigationTips">
                            Loading irrigation recommendations...
                        </div>
                    </div>
                </div>
                
                <div class="col-lg-4" data-aos="fade-up" data-aos-delay="300">
                    <div class="farming-tip-card">
                        <div class="tip-icon">
                            <i class="fas fa-bug"></i>
                        </div>
                        <h5 class="tip-title">Pest & Disease</h5>
                        <div class="tip-content" id="pestTips">
                            Loading pest management tips...
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="footer-modern">
        <div class="container">
            <div class="footer-content">
                <div class="row">
                    <div class="col-lg-4 col-md-6 mb-4">
                        <div class="footer-brand-modern">
                            <i class="fas fa-seedling me-2"></i>
                            <span>Kissan Connect</span>
                        </div>
                        <p class="footer-description-modern">
                            Empowering farmers with cutting-edge weather intelligence and AI technology.
                        </p>
                    </div>
                    <div class="col-lg-2 col-md-6 mb-4">
                        <h6 class="footer-title-modern">Services</h6>
                        <ul class="footer-links-modern">
                            <li><a href="{% url 'main:crop_suggestions' %}">Crop AI</a></li>
                            <li><a href="{% url 'main:weather' %}">Weather</a></li>
                            <li><a href="{% url 'main:disease_detection' %}">Disease Detection</a></li>
                        </ul>
                    </div>
                    <div class="col-lg-2 col-md-6 mb-4">
                        <h6 class="footer-title-modern">Company</h6>
                        <ul class="footer-links-modern">
                            <li><a href="{% url 'main:about' %}">About Us</a></li>
                            <li><a href="{% url 'main:contact' %}">Contact</a></li>
                        </ul>
                    </div>
                    <div class="col-lg-4 col-md-6 mb-4">
                        <h6 class="footer-title-modern">Weather Data</h6>
                        <p class="footer-description-modern">
                            Powered by OpenWeatherMap API for accurate, real-time weather information.
                        </p>
                    </div>
                </div>
            </div>
            <div class="footer-bottom-modern">
                <div class="row align-items-center">
                    <div class="col-md-6">
                        <p>&copy; 2024 Kissan Connect. All rights reserved.</p>
                    </div>
                    <div class="col-md-6 text-md-end">
                        <span class="weather-attribution">Weather data by OpenWeatherMap</span>
                    </div>
                </div>
            </div>
        </div>
    </footer>

    <!-- Loading Overlay -->
    <div class="weather-loading-overlay" id="loadingOverlay">
        <div class="weather-loading-content">
            <div class="weather-loading-spinner">
                <i class="fas fa-cloud-sun fa-spin"></i>
            </div>
            <h4>Fetching Weather Data...</h4>
            <p>Getting real-time conditions for your location</p>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
    <script src="{% static 'js/weather.js' %}"></script>
    
    <script>
        // Initialize AOS
        AOS.init({
            duration: 1000,
            once: true
        });
        
        // Auto-detect location on page load
        document.addEventListener('DOMContentLoaded', function() {
            console.log('üå§Ô∏è Weather page loaded');
            
            // Try to get user's location automatically
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(
                    function(position) {
                        console.log('üìç Location detected automatically');
                        getWeatherByCoordinates(position.coords.latitude, position.coords.longitude);
                    },
                    function(error) {
                        console.log('‚ùå Auto-location failed, showing search');
                        // Don't show error, just let user search manually
                    }
                );
            }
            
            // Allow Enter key to search
            document.getElementById('locationInput').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    getWeatherData();
                }
            });
        });
    </script>
</body>
</html>